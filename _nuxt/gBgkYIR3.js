import{_ as z,f as D,l as I,r as m,h as K,e as T,c as j,a as i,b as t,m as r,w as s,o as M,d as w,t as g}from"#entry";import q from"./BEBcsuY7.js";import u from"./4E9mHiY7.js";import c from"./B5Rp8oPm.js";import F from"./DQWc85La.js";import V from"./CTveXR6O.js";import C from"./CCciSrqF.js";import O from"./BV7_1V5A.js";import G from"./C1G497qJ.js";import H from"./C606-Ko9.js";import J from"./B3E57TI-.js";import{u as Q}from"./BVvCclix.js";import"./CoLSyHkG.js";import"./BA96TlVT.js";import"./cpzgCRYL.js";import"./CTjfiFnN.js";import"./Bmmxouqf.js";import"./C-P4eG7R.js";import"./G7qAH3-S.js";import"./C5ynMuxg.js";import"./jc0MLXVe.js";import"./CJskYxiL.js";import"./CLs7nh7g.js";import"./vwQloIhU.js";import"./CXKsnyIn.js";import"./DA4wmwat.js";import"./xT-WVbYN.js";import"./CjBpjVDB.js";import"./COuM4AeE.js";import"./CIubQrV5.js";import"./CJOrG8sJ.js";import"./ChBKel9d.js";import"./BMbmrZjI.js";import"./CsaQjRGF.js";import"./BJHql7T7.js";import"./ZhWAdK_X.js";import"./CLh_-5oz.js";import"./JYNMDp6K.js";import"./C1DPygkB.js";import"./DGWfkXqg.js";import"./Bljkj9EE.js";import"./DkzIYpue.js";import"./8jk2_tQ3.js";import"./CiNVQzof.js";import"./DEj1BPjW.js";import"./BIt-I3sC.js";import"./C_hlOuOa.js";import"./CrpQQ2Ce.js";import"./CZjQcvlU.js";import"./BdQ_wlQu.js";import"./CyzKzsh0.js";const W={class:"max-w-none mx-auto px-8"},X={class:"flex items-center justify-between mb-5"},Y={class:"flex items-center gap-2"},Z={class:"flex gap-2"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"md:col-span-2"},te={class:"flex items-center gap-2 mt-2"},re={class:"flex justify-end gap-2"},le={__name:"index",setup(ae){const n=D(),h=I(),{listar:$,criar:B,atualizar:S,excluir:N}=Q(),v=m(!1),f=m([]),y=m(""),d=m(!1),p=m(!1),k=()=>({id:null,sku:"",nome:"",preco:0,custo:0,ativo:!0}),a=m(k());function E(l){if(!l)return"—";try{return new Intl.DateTimeFormat("pt-BR",{dateStyle:"short",timeStyle:"short"}).format(new Date(l))}catch{return l}}const U=K(()=>{const l=y.value.trim().toLowerCase();return l?f.value.filter(e=>[e.nome,e.sku].some(o=>String(o||"").toLowerCase().includes(l))):f.value});async function b(){try{v.value=!0,f.value=await $()}catch(l){x("Falha ao carregar produtos",l)}finally{v.value=!1}}function L(){p.value=!1,a.value=k(),d.value=!0}function P(l){p.value=!0,a.value={...l},d.value=!0}async function R(){try{const l={sku:a.value.sku?.trim(),nome:a.value.nome?.trim(),preco:Number(a.value.preco||0),custo:Number(a.value.custo||0),ativo:!!a.value.ativo};if(!l.nome){n.add({severity:"warn",summary:"Atenção",detail:"Informe o nome do produto.",life:3e3});return}p.value&&a.value.id?(await S(a.value.id,l),n.add({severity:"success",summary:"Atualizado",detail:"Produto atualizado com sucesso.",life:2500})):(await B(l),n.add({severity:"success",summary:"Criado",detail:"Produto criado com sucesso.",life:2500})),d.value=!1,await b()}catch(l){x("Erro ao salvar produto",l)}}function _(l){h.require({message:`Excluir o produto "${l.nome}"?`,header:"Confirmar exclusão",icon:"pi pi-exclamation-triangle",acceptLabel:"Excluir",rejectLabel:"Cancelar",acceptClass:"p-button-danger",accept:async()=>{try{await N(l.id),n.add({severity:"success",summary:"Excluído",detail:"Produto removido.",life:2500}),await b()}catch(e){x("Erro ao excluir produto",e)}}})}function x(l,e){const o=e?.response?.data?.message||e?.message||"Tente novamente.";n.add({severity:"error",summary:"Erro",detail:`${l}: ${o}`,life:4e3}),console.error(e)}return T(b),(l,e)=>(M(),j("div",W,[i("div",X,[e[8]||(e[8]=i("h1",{class:"text-2xl font-bold"},"Produtos",-1)),i("div",Y,[t(r(V),{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),placeholder:"Buscar por nome ou SKU",class:"w-72 md:w-96"},null,8,["modelValue"]),t(r(c),{label:"Novo produto",icon:"pi pi-plus",onClick:L})])]),t(r(q),{value:U.value,loading:v.value,dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[10,20,50,100],size:"small",class:"shadow-sm rounded-lg w-full",style:{width:"100%"}},{default:s(()=>[t(r(u),{field:"id",header:"ID",style:{width:"90px"}}),t(r(u),{field:"sku",header:"SKU",style:{width:"160px"}}),t(r(u),{field:"nome",header:"Nome"}),t(r(u),{header:"Preço",style:{width:"140px"}},{body:s(({data:o})=>[w(g(Number(o.preco??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1)]),_:1}),t(r(u),{header:"Custo",style:{width:"140px"}},{body:s(({data:o})=>[w(g(Number(o.custo??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1)]),_:1}),t(r(u),{header:"Status",style:{width:"120px"}},{body:s(({data:o})=>[t(r(G),{value:o.ativo?"Ativo":"Inativo",severity:o.ativo?"success":"danger"},null,8,["value","severity"])]),_:1}),t(r(u),{header:"Criado em",style:{width:"190px"}},{body:s(({data:o})=>[w(g(E(o.criadoEm)),1)]),_:1}),t(r(u),{header:"Ações",style:{width:"160px"}},{body:s(({data:o})=>[i("div",Z,[t(r(c),{icon:"pi pi-pencil",severity:"secondary",outlined:"",onClick:A=>P(o)},null,8,["onClick"]),t(r(c),{icon:"pi pi-trash",severity:"danger",outlined:"",onClick:A=>_(o)},null,8,["onClick"])])]),_:1})]),_:1},8,["value","loading"]),t(r(F),{visible:d.value,"onUpdate:visible":e[7]||(e[7]=o=>d.value=o),header:p.value?"Editar produto":"Novo produto",modal:"",class:"w-full md:w-2/3 lg:w-1/2"},{footer:s(()=>[i("div",re,[t(r(c),{label:"Cancelar",severity:"secondary",outlined:"",onClick:e[6]||(e[6]=o=>d.value=!1)}),t(r(c),{label:p.value?"Salvar":"Criar",icon:"pi pi-check",onClick:R},null,8,["label"])])]),default:s(()=>[i("div",ee,[i("div",null,[e[9]||(e[9]=i("label",{class:"block text-sm mb-1"},"SKU",-1)),t(r(V),{modelValue:a.value.sku,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.sku=o),modelModifiers:{trim:!0},placeholder:"SKU"},null,8,["modelValue"])]),i("div",oe,[e[10]||(e[10]=i("label",{class:"block text-sm mb-1"},"Nome",-1)),t(r(V),{modelValue:a.value.nome,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.nome=o),modelModifiers:{trim:!0},placeholder:"Nome do produto"},null,8,["modelValue"])]),i("div",null,[e[11]||(e[11]=i("label",{class:"block text-sm mb-1"},"Preço",-1)),t(r(C),{modelValue:a.value.preco,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.preco=o),mode:"currency",currency:"BRL",locale:"pt-BR",min:0},null,8,["modelValue"])]),i("div",null,[e[12]||(e[12]=i("label",{class:"block text-sm mb-1"},"Custo",-1)),t(r(C),{modelValue:a.value.custo,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.custo=o),mode:"currency",currency:"BRL",locale:"pt-BR",min:0},null,8,["modelValue"])]),i("div",te,[t(r(O),{modelValue:a.value.ativo,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.ativo=o),binary:!0,"input-id":"ativo"},null,8,["modelValue"]),e[13]||(e[13]=i("label",{for:"ativo"},"Ativo",-1))])])]),_:1},8,["visible","header"]),t(r(H)),t(r(J))]))}},ro=z(le,[["__scopeId","data-v-39efbba1"]]);export{ro as default};
